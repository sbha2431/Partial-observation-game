\subsubsection{Forward belief-set propagation}

A \emph{path} in $G_\abstr$ is a sequence of states $s_0,\ldots,s_n$ such that $s_0 = s_\abstr^\init$ and $(s_i,s_{i+i}) \in \trans_\abstr$ for each $i < n$.

Given a path $\pi_\abstr = s_0,\ldots,s_n$ in $G_\abstr$ and an index $0 \leq i \leq n$, we define $\beliefF(\pi,i)\subseteq \states$ inductively as follows:
\begin{itemize}
\item if $i = 0$, then $\beliefF(\pi,i) = \{s^\init\}$,
\item if $i > 0$, $\beliefF(\pi,i) = \post(\beliefF(\pi,i-1)) \cap \gamma(s_i)$.
\end{itemize}

A counterexample strategy in $G_\abstr$ is called \emph{concretizable} if for every path $\pi_\abstr = s_0,\ldots,s_n$ in the corresponding counterexample tree where $s_n$ is a leaf node, it holds that $|\beliefF(\pi,n)| > k$.

\subsubsection{Backward partition splitting}
Consider a path $\pi_\abstr = s_0,\ldots,s_n$ in $G_\abstr$ such that for every index $0 \leq i \leq n$ we have $|\beliefF(\pi,n)| \leq k$. We now describe a procedure to compute a partitioning $\part'$ that refines the current partitioning $\part$ based on the path $\pi_\abstr$.


For $s_n  =(l_a,\{B_1,\ldots,B_m\})$, we split some of the partitions in $s_n$ to obtain from $A_n = \{B_1,\ldots,B_m\}$ a set $A_n' = \{B_1',\ldots, B'_{m'}\}$ such that $|\gamma(l_a,\{B_i' \in A_n' \mid \beliefF(\pi_\abstr, n) \cap B_i' \neq \emptyset\})| \leq k$.
This gives us a partitioning $Q^n$ that refines the current partitioning $Q$. To ensure that the counterexample is eliminated we have to propagate the information backwards along the path, possibly splitting the partitions further, obtaining refinements $Q^{n-1,\ldots,Q^0}$.
Let $C_n \subseteq A_n'$ be a maximal subset of $A_n'$ such that $|\gamma((l_a,C_n))| \leq k$ and if $\beliefF(\pi_\abstr, n) \cap B_i' \neq \emptyset$ then $B_i' \in C_n$.
For each $j = n-1,\ldots,0$ we do the following.

For $s_j  =(l_a,\{B_1,\ldots,B_m\})$, we split some of the partitions in $s_j$ to obtain from $A_j = \{B_1,\ldots,B_m\}$ a set $A_j' = \{B_1',\ldots, B'_{m'}\}$ such that there exists a subset $C_j'\subseteq A_j'$ such that for all $s' \in \post(\gamma(l_a,C_j'))$ there exists $B' \in C_{j+1}$ such that $s \in B'$. We fix a maximal such subset $C_j$ and the corresponding refinement $Q^j$ of the partitioning $Q_{j+1}$. 

We take as the refined partitioning $Q'$ the partitioning $Q^0$.

\begin{example}
\todo{illustrating example}
\end{example}
